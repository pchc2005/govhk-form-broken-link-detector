<!-- Timestamp Info -->
<div class="timestamp-info">
  <div>Last checked: {{ last_checked or 'N/A' }}</div>
  {% if last_auto_refresh %}
  <div>Last auto-refresh: {{ last_auto_refresh }}</div>
  {% endif %}
</div>

<!-- Status Cards -->
<div class="row mb-3">
  <div class="col-sm">
    <div class="card border-success mb-3">
      <div class="card-body text-success">
        <h5 class="card-title">‚úÖ OK </h5>
        <p class="card-text display-6">{{ ok_count }}</p>
      </div>
    </div>
  </div>
  <div class="col-sm">
    <div class="card border-warning mb-3">
      <div class="card-body text-warning">
        <h5 class="card-title">
          ‚ö†Ô∏è Warning
          <span data-bs-toggle="tooltip" data-bs-placement="top"
                title="Links that are reachable but have transport‚Äëlayer issues such as TLS Legacy Renegotiation Unsupported, TLS Handshake Failure, or SSL verification bypassed.">
            <i class="bi bi-question-circle-fill" style="cursor: pointer;"></i>
          </span>
        </h5>
        <p class="card-text display-6">{{ warning_count }}</p>
      </div>
    </div>
  </div>
  <div class="col-sm">
    <div class="card border-danger mb-3">
      <div class="card-body text-danger">
        <h5 class="card-title">‚ùå Errors / Broken</h5>
        <p class="card-text display-6">{{ error_count }}</p>
      </div>
    </div>
  </div>
  <div class="col-sm">
    <div class="card border-primary mb-3">
      <div class="card-body text-primary">
        <h5 class="card-title">üî¢ Total Links</h5>
        <p class="card-text display-6">{{ total_count }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Buttons -->
<a href="{{ url_for('refresh', dataset=dataset_name) }}" class="btn btn-primary mb-3">üîÑ Refresh</a>
<a href="{{ url_for('download_csv', dataset=dataset_name) }}" class="btn btn-success mb-3">‚¨á Export All (CSV)</a>
<a href="{{ url_for('download_errors', dataset=dataset_name) }}" class="btn btn-danger mb-3">‚¨á Export Errors Only</a>

<!-- Table -->
<table id="linkTable-{{ dataset_name }}" class="table table-striped table-hover">
  <thead class="table-dark">
    <tr>
      <th>#</th>
      <th>Department</th>
      <th>Title</th>
      <th>Lang</th>
      <th>URL</th>
      <th>Status</th>
      <th>First Broken</th>
    </tr>
  </thead>
  <tbody>
    {% for row in results %}
    <tr>
      <td>{{ loop.index }}</td>
      <td>{{ row['department'] }}</td>
      <td>{{ row['title'] }}</td>
      <td>{{ row['lang'] }}</td>
      <td><a href="{{ row['url'] }}" target="_blank">{{ row['url'] }}</a></td>
      <td class="{% if row['status'] == 'OK' %}text-success{% elif row['status'].startswith('Error') or row['status'] == 'Broken' %}text-danger{% else %}text-warning{% endif %}">
        {{ row['status'] }}
      </td>
      <td>{{ row['first_broken'] or '' }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
